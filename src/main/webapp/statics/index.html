<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <META HTTP-EQUIV="Pragma" CONTENT="no-cache">
    <META HTTP-EQUIV="Cache-Control" CONTENT="no-cache">
    <META HTTP-EQUIV="Expires" CONTENT="0">
    <title>查询库存</title>
    <link href="css/bootstrap.css" rel="stylesheet"/>
    <link rel="stylesheet" href="css/preset.css">
    <link/>

    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/cus.js"></script>

</head>
<body>
<h2>出入库管理系统</h2>
<p></p>
<ul class="nav nav-pills" role="tablist">
    <li role="presentation" class="active"><a href="#">查询库存</a></li>
    <li role="presentation"><a href="detail.html">出入记录</a></li>
    <li role="presentation"><a href="ruku.html">新增入库</a></li>
    <li role="presentation"><a href="out.html">新增出库</a></li>
    <li role="presentation"><a href="additemname.html">添加名称</a></li>
    <li role="presentation"><a href="additem.html">添加商品</a>
    <li><button id="logout" class="btn btn-warning" type="button">退出</button></li>
</ul>

<table id="tableindex" class="table table-striped table-bordered table-hover">
    <thead>
    <tr>
        <th><span>商品类型</span></th>
        <th><span>商品名称</span></th>
        <th><span>商品编码</span></th>
        <th><span>商品规格</span></th>
        <th><span>总入库</span></th>
        <th><span>总出库</span></th>
        <th><span>当前数量</span></th>
    </tr>
    </thead>
    <tbody id="table_body">


    </tbody>
</table>

<script>

    $(function () {
        var as = $("ul li a");

        for(var ay = 0;ay < as.length;ay++) {
            var href = as[ay].href;
            as[ay].href = href +"?_t="+new Date().getTime();
        }

        $.ajax({
            type: "POST",//请求方式，get或post
            url: "/item/get/all",
            data: '',
            contentType: "application/json; charset=utf-8",
            dataType: 'json',
            timeout: 15000,  //超时时间设置，单位毫秒
            error: function (XmlHttpRequest, textStatus, errorThrown) {

                alert('系统繁忙,请稍后再试');
            },
            success: function (data) {
                if(0 == data.code) {
                    $('#table_body').empty();  //清除表格内容

                    var arr = data.data;
                    if (arr == undefined) {
                        alert("无商品");
                        return;
                    }
                    else if (arr.length == 0) {
                        alert("无商品");
                        return;
                    }

                    var datalink = "{"+
                    "'F':'778317EA',"+
                            "'F1':'BD73F1E4',"+
                            "'F2':'4CA6DE6B',"+
                            "'F3':'54E5342F',"+
                            "'T':'1476417885',"+
                            "'y':'FDFBDFF2'"+

                "}";
                    var datalen = arr.length;
                    for (var i = 0; i < datalen; i++) {
                        var item = arr[i];
                        var sn = item.serialNumber;
                        $('#table_body').append('<tr id="state' + i + '">' +
                                '<td>' + item.typeName + '</td>' +
                                '<td>' + item.name + '</td>' +
                                '<td>' + item.specifications + '</td>' +
                                '<td>' + '<a data-click=datalink target="_blank" href="/statics/detail.html?_t='+new Date().getTime()+'&sn='+sn+'">'+sn+'</a></td>' +
                                '<td>' + item.quantityAll + '</td>' +
                                '<td>' + item.quantityUse + '</td>' +
                                '<td>' + item.quantityCurrent + '</td></tr>');
                    }
                }
                else if(1000 == data.code){
                    alert(data.message);
                    window.location=data.data;
                }
                else
                {
                    alert(data.message);
                }
            }
        });
    });

</script>

</body>
</html>